--- tapioca-qt.SVN-R2109.orig/src/CMakeLists.txt	2008-05-14 23:37:21.482044000 -0400
+++ tapioca-qt.SVN-R2109/src/CMakeLists.txt	2008-05-15 13:47:27.906031000 -0400
@@ -1,4 +1,4 @@
-set(QT_DONT_USE_QTGUI "YES")
+set(QT_DONT_USE_QTGUI TRUE)
 include(${QT_USE_FILE})
 
 set(INC_DIR ${CMAKE_SOURCE_DIR}/include)
@@ -6,6 +6,25 @@
                     ${QTTELEPATHY_INC_DIR}
                     ${CMAKE_BINARY_DIR} ${INC_DIR})
 
+FIND_LIBRARY(QT_QTCORE_LIBRARY
+    NAMES QtCore
+    PATHS ${QT_LIBRARY_DIR})
+
+FIND_LIBRARY(QT_QTDBUS_LIBRARY
+    NAMES QtDBus
+    PATHS ${QT_LIBRARY_DIR})
+
+IF(QT_QTCORE_LIBRARY AND QT_QTDBUS_LIBRARY)
+    SET(QT_LIBRARIES_FOUND TRUE)
+    MESSAGE(STATUS "Required QT Libraries found.")
+ELSE(QT_QTCORE_LIBRARY AND QT_QTDBUS_LIBRARY)
+    SET(QT_LIBRARIES_FOUND FALSE)
+    MESSAGE(FATAL_ERROR "Required QT Libraries NOT found.")
+ENDIF(QT_QTCORE_LIBRARY AND QT_QTDBUS_LIBRARY)
+
+MESSAGE(STATUS "QT_QTCORE_LIBRARY: ${QT_QTCORE_LIBRARY}")
+MESSAGE(STATUS "QT_QTDBUS_LIBRARY: ${QT_QTDBUS_LIBRARY}")
+
 # ######### QtTapioca library #########
 
 set(library_SRCS
@@ -55,6 +74,6 @@
 
 add_library(QtTapioca SHARED ${library_SRCS} ${library_MOC_SRCS})
 set_target_properties(QtTapioca PROPERTIES VERSION 0.1.0 SOVERSION 0)
-target_link_libraries(QtTapioca ${QT_LIBRARIES} ${QDBUS_LDFLAGS} ${QTTELEPATHY_LIBRARIES})
+target_link_libraries(QtTapioca ${QT_LIBRARIES} ${QDBUS_LDFLAGS} ${QT_QTCORE_LIBRARY} ${QT_QTDBUS_LIBRARY} ${QTTELEPATHY_LIBRARIES})
 install(TARGETS QtTapioca DESTINATION ${LIB_INSTALL_DIR})
 
